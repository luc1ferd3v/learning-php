<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bài Tập Document Object Model</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fraunces:ital,opsz,wght,SOFT,WONK@0,9..144,700,100,1;1,9..144,700,100,1&display=swap" rel="stylesheet">
    <style>
        body { margin: 20px; font-family: sans-serif; }
        * { box-sizing: border-box; }
        .highlight { background-color: yellow; color: red; }
        button { margin: 5px 0; cursor: pointer; }
    </style>
</head>

<body>
    <div class="action-buttons">
        <button id="btnTest">Xin Chào</button>
        <button id="myButton">Nhấn vào đây</button>
        <button id="hoverBtn">Di chuột vào đây</button>
        <button id="showTeammate">Hiển thị thành viên trong nhóm</button>
    </div>

    <hr>

    <form id="myForm">
        <input type="text" id="name" placeholder="Nhập tên của bạn...">
        <button type="submit">Gửi thông tin</button>
    </form>
    
    <br>
    <input type="text" id="inputBox" placeholder="Gõ phím bất kỳ...">

    <h1 id="title">Xin chào DOM!</h1>
    <p class="description">Đây là một đoạn văn có class.</p>
    <p class="description">Đây là đoạn văn thứ hai có cùng class.</p>
    
    <button id="changeContentBtn">Thay đổi nội dung</button>

    <ul id="list">
        <li>Phần tử 1</li>
        <li>Phần tử 2</li>
        <li>Phần tử 3</li>
    </ul>

<script>
    // --- 1. LOGIC XỬ LÝ SỐ & VÒNG LẶP CƠ BẢN ---
    // In ra số lẻ từ 1 đến 10 (Logic cũ: in nếu không chia hết cho 2)
    let count = 1;
    while (count <= 10) {
        if (count % 2 !== 0) {
            console.log(count);
        }
        count++;
    }

    // --- 2. XỬ LÝ SỰ KIỆN DOM (EVENT LISTENERS) ---
    const btnHello = document.querySelector("#btnTest");
    const btnClick = document.querySelector("#myButton");
    const btnHover = document.querySelector("#hoverBtn");
    const btnTeam = document.querySelector("#showTeammate");
    const formSubmit = document.querySelector("#myForm");
    const keyInput = document.querySelector("#inputBox");
    const btnChange = document.querySelector("#changeContentBtn"); // Thay cho onclick inline cũ

    btnHello.addEventListener("click", () => alert("Xin chào "));
    
    btnClick.addEventListener("click", () => alert("Sự kiện đã được kích hoạt"));

    btnHover.onmouseover = function() { this.style.color = "red"; };
    btnHover.onmouseout = function() { this.style.color = "buttontext"; };

    // Xử lý hiển thị nhóm
    btnTeam.addEventListener("click", () => {
        const members = ["Nguyễn Hà Đức Việt", "Đỗ Thị Thuý Quỳnh", "Lê Văn Tuấn", "Trịnh Đăng Quang"];
        
        members.slice(0, 4).forEach((mem, index) => {
            const h1Tag = document.createElement('h1');
            h1Tag.innerText = `Thành viên thứ ${index + 1}: ${mem}`;
            
            // Set styles
            Object.assign(h1Tag.style, {
                fontSize: '24px',
                color: '#000000',
                fontFamily: '"Fraunces", serif',
                fontWeight: '700',
                fontOpticalSizing: 'auto',
                fontStyle: 'auto',
                fontVariationSettings: '"SOFT" 100,"WONK" 1'
            });
            document.body.appendChild(h1Tag);
        });
    });

    // Xử lý Form
    formSubmit.addEventListener("submit", (e) => {
        const val = document.getElementById("name").value.trim();
        if (!val) {
            alert("Vui lòng nhập họ tên");
            e.preventDefault(); // Sửa lỗi cú pháp cũ: preventDefault() là hàm
        }
    });

    // Xử lý bàn phím
    keyInput.addEventListener("keydown", (e) => console.log("Bạn vừa nhấn phím", e.key));

    // Xử lý nút thay đổi nội dung (Chuyển từ inline onclick sang addEventListener cho sạch code)
    btnChange.addEventListener("click", () => {
        const mainTitle = document.getElementById("title");
        const descList = document.querySelectorAll(".description");
        
        mainTitle.textContent = "Nội dung đã thay đổi!";
        if(descList.length > 0) descList[0].classList.add("highlight");
    });

    // --- 3. CẤU TRÚC ĐIỀU KHIỂN (SWITCH CASE) ---
    const dayOfWeek = 3;
    const weekMap = {
        1: "Chủ nhật", 2: "Thứ 2", 3: "Thứ 3", 4: "Thứ 4", 
        5: "Thứ 5", 6: "Thứ 6", 7: "Thứ 7"
    };
    console.log(weekMap[dayOfWeek] || "Không hợp lệ"); // Cách viết gọn thay cho switch case dài dòng

    // --- 4. ARRAY & OBJECT LOOPS ---
    const fruitsArr = ["Apple", "Banana", "Orange"];
    fruitsArr.forEach(f => console.log(f));

    const devProfile = { name: "Nam", age: "25", job: "developer" };
    Object.keys(devProfile).forEach(key => {
        console.log(`${key}: ${devProfile[key]}`);
    });

    // Vòng lặp while
    let iterator = 1;
    while (iterator <= 5) {
        console.log(iterator);
        iterator++;
    }

    // Break / Continue loops
    for (let k = 1; k <= 10; k++) {
        if (k === 5) break;
        console.log(k);
    }

    for (let m = 1; m <= 10; m++) {
        if (m % 2 !== 0) console.log(m); // Logic tương đương continue số lẻ
    }

    // --- 5. TIMERS ---
    setTimeout(() => console.log("Chạy sau 3 giây!"), 3000);
    setInterval(() => console.log("Chạy mỗi 2 giây!"), 2000);

    // --- 6. XỬ LÝ CHUỖI (STRING) ---
    const sampleText = " JavaScript là một ngôn ngữ lập trình tuyệt vời! ";
    
    console.log("Độ dài chuỗi:", sampleText.length);
    console.log("Ký tự đầu tiên:", sampleText.charAt(0));
    console.log("Mã ASCII:", sampleText.charCodeAt(0));
    console.log("Truy cập index:", sampleText[0]);

    // Cắt chuỗi
    console.log("slice(2, 10):", sampleText.slice(2, 10));
    console.log("substring(2, 10):", sampleText.substring(2, 10));
    console.log("substr(2, 10):", sampleText.substr(2, 10));

    // Case
    console.log("Viết hoa:", sampleText.toUpperCase());
    console.log("Viết thường:", sampleText.toLowerCase());

    // Nối chuỗi
    const s1 = "Xin chào";
    const s2 = "JavaScript";
    console.log("Nối bằng concat():", s1.concat(" ", s2));
    console.log("Nối bằng + :", `${s1} ${s2}`); // Dùng Template Literal

    // Trim
    console.log("Trim:", sampleText.trim());
    console.log("TrimStart:", sampleText.trimStart());
    console.log("TrimEnd:", sampleText.trimEnd());

    // Kiểm tra
    console.log("Có chứa 'JavaScript'?:", sampleText.includes("JavaScript"));
    console.log("Bắt đầu bằng 'JavaScript'?:", sampleText.startsWith("JavaScript"));
    console.log("Kết thúc bằng 'vời!'?:", sampleText.endsWith("vời!"));

    // Tìm kiếm
    console.log("Index đầu 'a':", sampleText.indexOf("a"));
    console.log("Index cuối 'a':", sampleText.lastIndexOf("a"));
    console.log("Search 'lập trình':", sampleText.search("lập trình"));

    // Replace
    console.log("Replace JS:", sampleText.replace("JavaScript", "JS"));
    console.log("Replace All a -> A:", sampleText.replaceAll("a", "A"));

    // Split
    const techStack = "HTML, CSS, JavaScript, React";
    console.log("Split mảng:", techStack.split(", "));

    // Template String
    const uName = "Alice", uAge = 25;
    const infoMsg = `Tên: ${uName}, Tuổi: ${uAge}, đang học ${s2}`;
    console.log("Template Literals:", infoMsg);
    
    console.log(`Chuỗi nhiều dòng:\nDòng 1\nDòng 2\nDòng 3`);

    // --- 7. DATE & TIME ---
    const now = new Date();
    console.log("Thời gian hiện tại:", now);
    console.log(`Năm: ${now.getFullYear()}, Tháng: ${now.getMonth() + 1}, Ngày: ${now.getDate()}`);
    console.log(`Giờ: ${now.getHours()}, Phút: ${now.getMinutes()}, Giây: ${now.getSeconds()}`);

    // Modify date
    now.setFullYear(2025, 5, 15); // Set năm tháng ngày cùng lúc cho gọn
    console.log("Sau khi chỉnh sửa:", now);

    // Format
    console.log("DateString:", now.toDateString());
    console.log("ISO:", now.toISOString());
    console.log("Locale (VN):", now.toLocaleDateString('vi-VN'));
    console.log("Timestamp:", now.getTime());

    // Tính khoảng cách ngày
    const d1 = new Date("2024-03-01");
    const d2 = new Date("2024-03-05");
    const dayDiff = (d2 - d1) / (1000 * 60 * 60 * 24);
    console.log(`Khoảng cách giữa ${d1.toDateString()} và ${d2.toDateString()} là: ${dayDiff} ngày`);

    // Cộng trừ ngày
    const dateCalc = new Date();
    dateCalc.setDate(dateCalc.getDate() + 7);
    console.log("7 ngày sau:", dateCalc);
    dateCalc.setDate(dateCalc.getDate() - 21); // Trừ đi 14 (từ gốc +7 -21 = -14)
    console.log("14 ngày trước:", dateCalc);

    // --- 8. MATH FUNCTION ---
    console.log("PI:", Math.PI, "| E:", Math.E, "| SQRT2:", Math.SQRT2);
    console.log("Abs(-10):", Math.abs(-10));
    console.log(`Floor: ${Math.floor(4.7)} | Ceil: ${Math.ceil(4.3)} | Round: ${Math.round(4.5)}`);
    console.log("Pow(2,3):", 2 ** 3); // Dùng toán tử lũy thừa mới
    console.log("Sqrt(16):", Math.sqrt(16));
    
    const nums = [10, 20, 5, 40];
    console.log("Max:", Math.max(...nums)); // Dùng spread operator
    console.log("Min:", Math.min(...nums));

    console.log("Sin(90):", Math.sin(90 * Math.PI / 180));
    console.log("Cos(0):", Math.cos(0));
    console.log("Random 0-1:", Math.random());
    console.log("Random 1-100:", Math.floor(Math.random() * 100) + 1);
    console.log("Log(10):", Math.log(10));
    console.log("Log10(100):", Math.log10(100));

    // --- 9. ARRAY METHODS ---
    const listFruits = ["Táo", "Chuối", "Cam", "Dâu"];
    console.log("Mảng ban đầu:", listFruits);
    console.log("Length:", listFruits.length);

    listFruits.push("Xoài");
    console.log("Push Xoài:", listFruits);
    listFruits.pop();
    console.log("Pop:", listFruits);
    
    listFruits.unshift("Nho");
    console.log("Unshift Nho:", listFruits);
    listFruits.shift();
    console.log("Shift:", listFruits);

    console.log("Slice(1,3):", listFruits.slice(1, 3));
    console.log("Concat:", listFruits.concat(["Xoài", "Dưa hấu"]));
    
    console.log("Index of Cam:", listFruits.indexOf("Cam"));
    console.log("Includes Dưa hấu?:", listFruits.includes("Dưa hấu"));

    console.log("Sort:", [...listFruits].sort()); // Sort bản sao để không ảnh hưởng mảng gốc nếu cần
    console.log("Reverse:", listFruits.reverse());

    console.log("ForEach:");
    listFruits.forEach(item => console.log(item));

    const upperList = listFruits.map(f => f.toUpperCase());
    console.log("Map Upper:", upperList);

    const shortList = listFruits.filter(f => f.length <= 3);
    console.log("Filter <=3 ký tự:", shortList);

    const sumArr = [10, 20, 30, 40];
    const totalSum = sumArr.reduce((acc, curr) => acc + curr, 0);
    console.log("Reduce Sum:", totalSum);

    // --- 10. DOM MANIPULATION (STYLE) ---
    // Gom nhóm các thao tác style lại cuối cùng
    const domTitle = document.getElementById("title");
    domTitle.style.color = "blue";

    document.getElementsByTagName("p")[0].style.fontSize = "20px";
    document.getElementsByClassName("description")[1].style.fontWeight = "bold";

    document.querySelector("#list li").style.backgroundColor = "yellow";
    
    document.querySelectorAll("#list li").forEach(li => {
        li.style.margin = "10px";
    });

</script>
</body>
</html>